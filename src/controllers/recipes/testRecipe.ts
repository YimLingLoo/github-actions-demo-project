this is a messy code